
> @legible-sync/example-express@1.2.2 test
> jest

watchman warning:  Recrawled this watch 1 time, most recently because:
MustScanSubDirs UserDroppedTo resolve, please review the information on
https://facebook.github.io/watchman/docs/troubleshooting.html#recrawl
To clear this warning, run:
`watchman watch-del '/Users/mastepanoski/projects/web/ai/legible-sync' ; watchman watch-project '/Users/mastepanoski/projects/web/ai/legible-sync'`

FAIL __tests__/integration/syncs.test.ts
  ● Express Sync Rules Integration Tests › Article Syncs › should call Article.create when Web.request POST /articles and JWT.verify succeed

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "create", ObjectContaining {"article": Any<String>, "author": "test-user", "body": "Test content", "title": "Test Article"}

    Number of calls: 0

      152 |       // The sync should trigger JWT.verify and then Article.create
      153 |       // Check that Article.create was called with correct parameters
    > 154 |       expect(mockConcepts.Article.__spy).toHaveBeenCalledWith('create', expect.objectContaining({
          |                                          ^
      155 |         article: expect.any(String),
      156 |         title: 'Test Article',
      157 |         body: 'Test content',

      at Object.<anonymous> (__tests__/integration/syncs.test.ts:154:42)

  ● Express Sync Rules Integration Tests › Comment Syncs › should call Comment.create when Web.request POST /articles/*/comments and JWT.verify succeed

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "create", ObjectContaining {"article": "article123", "author": "test-user", "body": "Test comment", "comment": Any<String>}

    Number of calls: 0

      179 |       // The sync should trigger JWT.verify and then Comment.create
      180 |       // Check that Comment.create was called
    > 181 |       expect(mockConcepts.Comment.__spy).toHaveBeenCalledWith('create', expect.objectContaining({
          |                                          ^
      182 |         comment: expect.any(String),
      183 |         article: 'article123',
      184 |         author: 'test-user',

      at Object.<anonymous> (__tests__/integration/syncs.test.ts:181:42)

  ● Express Sync Rules Integration Tests › Favorite Syncs › should call Favorite.add when Web.request POST /articles/*/favorite and JWT.verify succeed

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "add", ObjectContaining {"article": "article123", "user": "test-user"}

    Number of calls: 0

      205 |       // The sync should trigger JWT.verify and then Favorite.add
      206 |       // Check that Favorite.add was called
    > 207 |       expect(mockConcepts.Favorite.__spy).toHaveBeenCalledWith('add', expect.objectContaining({
          |                                           ^
      208 |         article: 'article123',
      209 |         user: 'test-user'
      210 |       }));

      at Object.<anonymous> (__tests__/integration/syncs.test.ts:207:43)

  ● Express Sync Rules Integration Tests › Favorite Syncs › should call Favorite.remove when Web.request DELETE /articles/*/favorite and JWT.verify succeed

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "remove", ObjectContaining {"article": "article123", "user": "test-user"}

    Number of calls: 0

      227 |       // The sync should trigger JWT.verify and then Favorite.remove
      228 |       // Check that Favorite.remove was called
    > 229 |       expect(mockConcepts.Favorite.__spy).toHaveBeenCalledWith('remove', expect.objectContaining({
          |                                           ^
      230 |         article: 'article123',
      231 |         user: 'test-user'
      232 |       }));

      at Object.<anonymous> (__tests__/integration/syncs.test.ts:229:43)

PASS __tests__/integration/api.test.ts
  ● Console

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: 'a1811176-ce09-4456-8488-7b15334fe80d',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778181',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: 'fc2cd650-3835-4316-9a81-49761fac40a3' }
        },
        {
          id: 'cb58c5b0-cf34-448d-b801-a904c7e36d08',
          concept: 'Password',
          action: 'validate',
          input: { password: 'password123' },
          flow: 'flow-1763759778181',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { valid: true }
        },
        {
          id: '3ffb8b03-eb95-4d9e-8887-fcc3109e7208',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
          flow: 'flow-1763759778181',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()' }
        },
        {
          id: 'fec031a8-6cdf-4daf-bb14-bb354b5d27a1',
          concept: 'Password',
          action: 'set',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778181',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: '7052843a-658f-49e0-b441-27096a4002ee',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778181',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: '3ffb8b03-eb95-4d9e-8887-fcc3109e7208',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
        flow: 'flow-1763759778181',
        syncEdges: {},
        syncTriggered: true,
        output: { user: 'uuid()' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: '92409f20-b904-4d78-a0c4-9f465d2611b3',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778232',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: 'f8103ece-891a-40d8-8692-ce0584172b4d' }
        },
        {
          id: '5fbc2061-318e-49bb-b8dd-4b6cb5441d69',
          concept: 'Password',
          action: 'validate',
          input: { password: '123' },
          flow: 'flow-1763759778232',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { error: 'Password too short' }
        },
        {
          id: '375af058-0516-4f2e-9da8-fbb6cedf9df4',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: '', email: 'invalid-email' },
          flow: 'flow-1763759778232',
          syncEdges: {},
          syncTriggered: true,
          output: { error: 'Username required' }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: '375af058-0516-4f2e-9da8-fbb6cedf9df4',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: '', email: 'invalid-email' },
        flow: 'flow-1763759778232',
        syncEdges: {},
        syncTriggered: true,
        output: { error: 'Username required' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: '99462316-d8c5-4f70-9762-d096c3b3a1c0',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778233',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: '9e68e036-11c7-41d0-a145-536c78102eed' }
        },
        {
          id: 'd22b0de5-fe83-4da5-92c0-27cd9d1cfea8',
          concept: 'Password',
          action: 'validate',
          input: { password: 'password123' },
          flow: 'flow-1763759778233',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { valid: true }
        },
        {
          id: 'cd7761a8-cc0e-44e6-8fc2-2a23b153175d',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
          flow: 'flow-1763759778233',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()' }
        },
        {
          id: '0d2a91e0-4b42-4742-b469-aea4a2583d1c',
          concept: 'Password',
          action: 'set',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778233',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: 'dba82a9e-bd82-4048-b56d-d5e39fb496f9',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778233',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: 'cd7761a8-cc0e-44e6-8fc2-2a23b153175d',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
        flow: 'flow-1763759778233',
        syncEdges: {},
        syncTriggered: true,
        output: { user: 'uuid()' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /login

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /login] All actions in flow: [
        {
          id: '75f6347f-7642-4e8b-bd30-438d0fd1aa40',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/login', body: [Object], token: null },
          flow: 'flow-1763759778274',
          syncEdges: { LoginUser: [Array] },
          syncTriggered: false,
          output: { request: '420803b7-7b34-493d-b07f-f7f2c45e5f77' }
        },
        {
          id: '1456056a-2927-4d2f-9f71-76223a354a59',
          concept: 'User',
          action: 'getByUsername',
          input: { username: 'testuser' },
          flow: 'flow-1763759778274',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()', username: 'testuser', email: 'test@example.com' }
        },
        {
          id: '99033072-6676-49e7-bb0d-65a675fd6c42',
          concept: 'Password',
          action: 'verify',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778274',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: '1a0fbcf6-7993-4df5-9b4d-2613238a78cd',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778274',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:100:13

    console.log
      [POST /login] Password.verify action: {
        id: '99033072-6676-49e7-bb0d-65a675fd6c42',
        concept: 'Password',
        action: 'verify',
        input: { user: '?user', password: 'password123' },
        flow: 'flow-1763759778274',
        syncEdges: {},
        syncTriggered: true,
        output: { user: '?user' }
      }

      at src/server.ts:102:13

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: '4c5270c2-fb2b-4457-886d-3bfc4c890dee',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778315',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: '84a94f4b-dbe9-4555-82ff-1c69380bd5dc' }
        },
        {
          id: 'e9c0f8f0-ffc4-4b6b-869e-e0835252c208',
          concept: 'Password',
          action: 'validate',
          input: { password: 'password123' },
          flow: 'flow-1763759778315',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { valid: true }
        },
        {
          id: '48e0f933-8af0-4abe-ab2b-d07e00c54185',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
          flow: 'flow-1763759778315',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()' }
        },
        {
          id: '2b7786ec-07a3-4b97-8ba7-14747ad4671c',
          concept: 'Password',
          action: 'set',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778315',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: '98bfcfaf-71aa-4371-9460-828f2ce6ed3c',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778315',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: '48e0f933-8af0-4abe-ab2b-d07e00c54185',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
        flow: 'flow-1763759778315',
        syncEdges: {},
        syncTriggered: true,
        output: { user: 'uuid()' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /login

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /login] All actions in flow: [
        {
          id: 'fe3403d3-e3dc-4355-ab59-6f28062ba77e',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/login', body: [Object], token: null },
          flow: 'flow-1763759778356',
          syncEdges: { LoginUser: [Array] },
          syncTriggered: false,
          output: { request: 'd2d107f5-52e1-4551-84d1-1c8abedcb1d9' }
        },
        {
          id: 'be6ec7fc-03a4-4d89-9c6d-a0b74b33eed3',
          concept: 'User',
          action: 'getByUsername',
          input: { username: 'testuser' },
          flow: 'flow-1763759778356',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()', username: 'testuser', email: 'test@example.com' }
        },
        {
          id: '99bd3fd6-19ef-4750-8dd8-69ac86c12653',
          concept: 'Password',
          action: 'verify',
          input: { user: '?user', password: 'wrongpassword' },
          flow: 'flow-1763759778356',
          syncEdges: {},
          syncTriggered: true,
          output: { error: 'Invalid password' }
        }
      ]

      at src/server.ts:100:13

    console.log
      [POST /login] Password.verify action: {
        id: '99bd3fd6-19ef-4750-8dd8-69ac86c12653',
        concept: 'Password',
        action: 'verify',
        input: { user: '?user', password: 'wrongpassword' },
        flow: 'flow-1763759778356',
        syncEdges: {},
        syncTriggered: true,
        output: { error: 'Invalid password' }
      }

      at src/server.ts:102:13

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: 'efe9ec50-f09f-4310-b15a-5bc8f2459af4',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778397',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: 'bdf54010-a3b8-40ff-9b05-ecb47f14854a' }
        },
        {
          id: '77fc9a4f-53fc-46fc-ab4a-09a980922990',
          concept: 'Password',
          action: 'validate',
          input: { password: 'password123' },
          flow: 'flow-1763759778397',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { valid: true }
        },
        {
          id: '17323845-3847-4610-b588-8d2157423fec',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
          flow: 'flow-1763759778397',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()' }
        },
        {
          id: 'a322bf61-bb38-40e5-a7e0-86f4409615f2',
          concept: 'Password',
          action: 'set',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778397',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: 'd8ec8acb-9ecc-4df6-9eb5-3183b1c446e8',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778397',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: '17323845-3847-4610-b588-8d2157423fec',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
        flow: 'flow-1763759778397',
        syncEdges: {},
        syncTriggered: true,
        output: { user: 'uuid()' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /articles

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: '08f37a73-d7c3-4c77-bb04-d2e43ec4068e',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778440',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: 'e6746308-056d-4401-af20-92341831feef' }
        },
        {
          id: 'a378177f-3095-4653-a5c9-264c466bf9f9',
          concept: 'Password',
          action: 'validate',
          input: { password: 'password123' },
          flow: 'flow-1763759778440',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { valid: true }
        },
        {
          id: '1bc19740-7e65-4c46-acfb-d90b5c397f18',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
          flow: 'flow-1763759778440',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()' }
        },
        {
          id: 'a626e69a-285e-4527-843b-908355418945',
          concept: 'Password',
          action: 'set',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778440',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: '9a96459b-67ed-45b3-bf4c-d02f99967024',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778440',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: '1bc19740-7e65-4c46-acfb-d90b5c397f18',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
        flow: 'flow-1763759778440',
        syncEdges: {},
        syncTriggered: true,
        output: { user: 'uuid()' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: '58275219-8804-44f5-83d1-93619c68e889',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778482',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: 'eefdc263-42f4-4071-a76c-a47fa12f5b62' }
        },
        {
          id: '974564e1-37f8-4565-92fb-fa422765957f',
          concept: 'Password',
          action: 'validate',
          input: { password: 'password123' },
          flow: 'flow-1763759778482',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { valid: true }
        },
        {
          id: 'f05ec55a-0b70-407e-a845-a3f1bee5f930',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
          flow: 'flow-1763759778482',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()' }
        },
        {
          id: '0589fac3-1cd5-4aee-93e9-011cb46f4664',
          concept: 'Password',
          action: 'set',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778482',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: 'eafe3f7a-8126-423c-8f79-19f26ad7efeb',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778482',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: 'f05ec55a-0b70-407e-a845-a3f1bee5f930',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
        flow: 'flow-1763759778482',
        syncEdges: {},
        syncTriggered: true,
        output: { user: 'uuid()' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /articles

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [HTTP] POST /articles/uuid()/favorite

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [HTTP] POST /users

      at Object.execute (src/concepts/Web.ts:14:15)

    console.log
      [POST /users] All actions in flow: [
        {
          id: 'd639fdd8-5001-4f95-bdb7-7ae2e546b857',
          concept: 'Web',
          action: 'request',
          input: { method: 'POST', path: '/users', body: [Object], token: null },
          flow: 'flow-1763759778524',
          syncEdges: {
            ValidatePasswordFirst: [Array],
            RegisterOnValidPassword: [Array]
          },
          syncTriggered: false,
          output: { request: 'f0d1d8f6-4adb-4a55-bffb-efda2e310adc' }
        },
        {
          id: 'cc0c58c4-f584-40a7-9312-e3c4a488afdd',
          concept: 'Password',
          action: 'validate',
          input: { password: 'password123' },
          flow: 'flow-1763759778524',
          syncEdges: { RegisterOnValidPassword: [Array] },
          syncTriggered: true,
          output: { valid: true }
        },
        {
          id: 'b63ca2da-323a-4e15-b63f-3c93a1aedcc5',
          concept: 'User',
          action: 'register',
          input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
          flow: 'flow-1763759778524',
          syncEdges: {},
          syncTriggered: true,
          output: { user: 'uuid()' }
        },
        {
          id: '39d04762-3290-4652-9c83-fd6f3b582a16',
          concept: 'Password',
          action: 'set',
          input: { user: '?user', password: 'password123' },
          flow: 'flow-1763759778524',
          syncEdges: {},
          syncTriggered: true,
          output: { user: '?user' }
        },
        {
          id: 'f84bc15f-259a-4d4e-8a34-8f30939bbc68',
          concept: 'JWT',
          action: 'generate',
          input: { user: '?user' },
          flow: 'flow-1763759778524',
          syncEdges: {},
          syncTriggered: true,
          output: {
            token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiP3VzZXIiLCJpYXQiOjE3NjM3NTk3NzgsImV4cCI6MTc2Mzg0NjE3OH0.U2TlXf1xkAZJJpsdG9TLP0E1rXHyRDTzL2xccNzUEYg'
          }
        }
      ]

      at src/server.ts:56:13

    console.log
      [POST /users] User.register action: {
        id: 'b63ca2da-323a-4e15-b63f-3c93a1aedcc5',
        concept: 'User',
        action: 'register',
        input: { user: 'uuid()', username: 'testuser', email: 'test@example.com' },
        flow: 'flow-1763759778524',
        syncEdges: {},
        syncTriggered: true,
        output: { user: 'uuid()' }
      }

      at src/server.ts:58:13

    console.log
      [HTTP] POST /articles

      at Object.execute (src/concepts/Web.ts:14:15)


Test Suites: 1 failed, 1 passed, 2 total
Tests:       4 failed, 15 passed, 19 total
Snapshots:   0 total
Time:        1.163 s, estimated 2 s
Ran all test suites.
npm error Lifecycle script `test` failed with error:
npm error code 1
npm error path /Users/mastepanoski/projects/web/ai/legible-sync/packages/example-express
npm error workspace @legible-sync/example-express@1.2.2
npm error location /Users/mastepanoski/projects/web/ai/legible-sync/packages/example-express
npm error command failed
npm error command sh -c jest
